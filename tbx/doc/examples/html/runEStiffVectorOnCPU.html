<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2020a"><title>Script to compute the ELEMENTAL STIFFNESS  code for the VECTOR problem on the CPU</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin-bottom: 20px; padding-bottom: 4px;  }
.S3 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 700; text-align: start;  }
.S4 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: start;  }
.S5 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
.diagnosticMessage-wrapper {font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement,.rtcDataTipElement .textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {min-height: 16px;}
.rightPaneElement .textElement {padding-top: 2px; padding-left: 9px;}
.S11 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S12 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S13 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_EE119605' ><span>Script to compute the ELEMENTAL STIFFNESS </span><span texencoding="$\mathbf{k}_e$" style="vertical-align:-12px"><img src="data:image/png;base64,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" width="31" height="38" /></span><span> code for the VECTOR problem on the CPU</span></h1><div  class = 'S1'><span>This script is used to compute the NNZ values for the global stiffness matrix </span><span texencoding="$\mathbf{K}$" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAkCAYAAAB15jFqAAAB3klEQVRYR+3WPciOYRQH8N8rq0VJJmWRIgaxKDKZSFlEpIgshFBIFsnnQD6LlI9FiY2iKMlmk4GYZGGQRIpOXXfdXe6P535vT+/wvGe9rnP+1/lf5/zPGTMBNjYBmCZBh8r66NI7ByewBLNrOP6IJ9iHr1iDXViI6ZnPNzzFHrwvzuronYaz2JoFuYQDiGC5zccdLMAjnMZz/MovNv3pJtzMHCKrhzUMrMQtXMUpfK+rxibQDSlI2XcZXlQEm4fruI3L+N1U/v8DdC6uJVaCmUbAeExf0Ci2C+kPWzNsK6Q4b6N3Jq7gJc4MkmFf0AA8j7c4jh9dJGw89L5JvbwND7Adn4cJugqrsbMEEtQews9Bgbtm+gmzKlRnB+7izyDAXUFDkd4ltSnHD2ncjGfDAA1xeI2TGcWBFaKxER/agLtmWihS0S4hi2W7iP1NEthXHBbjXsU0OtjWt+PNtHjw+qS1MZUKiwm0Do+HJfhTsTf1bRnjFbYgevof65NpEWxGksO1WfRa4egKujwN5vz1MdpuYGl2EBJ5NNflrpvDORypqM4pOIbDgwhHDho7Ukz9FRX7ThHvS9Lc+Muw6NmYqYtQLqhyYd3H7rRTTW74bULW73x0N/x+vA3oPTr0/gUOhHElRPbQjgAAAABJRU5ErkJggg==" width="14.5" height="18" /></span><span> in the VECTOR problem on the CPU, i.e. numerical integration of </span><span texencoding="$\mathbf{k}_e$" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAAB+ElEQVRYR+3WPehOYRjH8c+fQYjFQBEZZFJK8hJCGCgmg7ylvIbyUoxCXkKEARkMCKWwMCgxECGDwWLAoCSELFJ01X3qpPP3f85zOs9jOPd6nrvf97mu6/e7rx5dPj1d1tcANBX47yowCZcx/i93zMDDOhxTVIGxuIIpOcGOAgzCSaztFsBAnMCGBqCpQEEFhuIQFmFM7vtjbMHzslYtsmErQzgLD3ADu/Eav8uKx+/bARiMI+luiH9vRzi7UxZgAHZgFHbhRxXxshV4lsTHYTu+VhUvAzAbU3EYb7E6zUBlhlZb8AjTc2q3UlJ+qErQKsBRjMDKnOBB7MGvKhCtAsRr+BkXcq9kTP96XO0UQLRhGc5iSBJ9gjV41S5EmQrEQhIhFRkQqZed88kVbVmyCKCvfWAkLmJODmIbThWkYb/UsmkYjU84ns+PVjeihbiTE4xdIVqRnSJrxtAewLtUtcnJugtwt7ck7G0njAEMwf1Yh80Fe2NALMVTDMc5fMFOfMNezMQqvPlXFLc7T9m9/immt2JFWmbDLfMSxIt8q+pYy2OjvoafuJcccxv3i96OOgAWI5IyHq3TfQVVHQDLcQkb0xxkrRmGcMXHfI/rAJiIm3iJTXiPuZiPY50AiD+1BPswAZGWZ3C9UzNQykV1tKABaCpQqgJ/AB5WdSm9PA/tAAAAAElFTkSuQmCC" width="16" height="20" /></span><span>.</span></div><div  class = 'S1'><span>For more information, see the </span><a href = "https://github.com/fjramireg/StiffMa"><span>StiffMa</span></a><span> web site.</span></div><div  class = 'S2'><div  class = 'S3'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S4'><a href = "#H_83581889"><span>Inputs
</span></a><a href = "#H_0EE8089F"><span>Mesh generation
</span></a><a href = "#H_D584400C"><span>Material properties
</span></a><a href = "#H_638E11C5"><span>General Settings
</span></a><a href = "#H_3FC1D62A"><span>Element stiffness matrix computation on CPU
</span></a><a href = "#H_9A402150"><span>Element stiffness matrix computation on CPU (symmetry)
</span></a><a href = "#H_8FBF1AC3"><span>Credits</span></a></div></div><h2  class = 'S5' id = 'H_83581889' ><span>Inputs</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>nelx = 10;              </span><span style="color: rgb(60, 118, 61);">% Number of elements on X-direction</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>nely = 10;              </span><span style="color: rgb(60, 118, 61);">% Number of elements on Y-direction</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>nelz = 10;              </span><span style="color: rgb(60, 118, 61);">% Number of elements on Z-direction</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>sets.dTE = </span><span style="color: rgb(160, 32, 240);">'uint32'</span><span>;    </span><span style="color: rgb(60, 118, 61);">% Data precision for "elements" ['uint32', 'uint64']</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre;"><span>sets.dTN = </span><span style="color: rgb(160, 32, 240);">'single'</span><span>;    </span><span style="color: rgb(60, 118, 61);">% Data precision for "nodes" ['single' or 'double']</span></span></div></div></div><h2  class = 'S5' id = 'H_0EE8089F' ><span>Mesh generation</span></h2><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S9'><span style="white-space: pre;"><span>[Mesh.elements, Mesh.nodes] = CreateMesh2(nelx, nely, nelz, sets);</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement scrollableOutput" uid="80E0EF3B" contenteditable="false" data-testid="output_0" data-width="428" data-height="18" data-hashorizontaloverflow="true" style="width: 458px; max-height: 261px;"><div class="textElement">	Mesh created successfully with 1000 Hex8 elements and 1331 nodes!</div></div></div></div></div><h2  class = 'S5' id = 'H_D584400C' ><span>Material properties</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>MP.E = 200e9;      	</span><span style="color: rgb(60, 118, 61);">% Elastic modulus (homogeneous, linear, isotropic material)</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre;"><span>MP.nu = 0.3;       	</span><span style="color: rgb(60, 118, 61);">% Poisson ratio</span></span></div></div></div><h2  class = 'S5' id = 'H_638E11C5' ><span>General Settings</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>[sets.nel, sets.nxe]  = size(Mesh.elements);    </span><span style="color: rgb(60, 118, 61);">% Number of elements in the mesh &amp; Number of nodes per element</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>[sets.nnod, sets.dim] = size(Mesh.nodes);       </span><span style="color: rgb(60, 118, 61);">% Number of nodes in the mesh &amp; Space dimension</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>sets.dxn = 3;                                   </span><span style="color: rgb(60, 118, 61);">% Number of DOFs per node for the vector problem</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>sets.edof = sets.dxn * sets.nxe;                </span><span style="color: rgb(60, 118, 61);">% Number of DOFs per element</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>sets.sz = (sets.edof * (sets.edof + 1) )/2;     </span><span style="color: rgb(60, 118, 61);">% Number of NNZ values for each Ke using simmetry</span></span></div></div><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre;"><span>sets.tdofs = sets.nnod * sets.dxn;              </span><span style="color: rgb(60, 118, 61);">% Number of total DOFs in the mesh</span></span></div></div></div><h2  class = 'S5' id = 'H_3FC1D62A' ><span>Element stiffness matrix computation on CPU</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>tic;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>Ke_hf = eStiff_vsa(Mesh, MP, sets);        </span><span style="color: rgb(60, 118, 61);">% Computation of Ke for K</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>times = toc;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'Elapsed time for computing Ke for K on serial CPU: %f\n'</span><span>,times);</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="C4F20D99" contenteditable="false" data-testid="output_1" style="width: 458px; max-height: 261px;" data-width="428" data-height="18" data-hashorizontaloverflow="false"><div class="textElement">Elapsed time for computing Ke for K on serial CPU: 0.272670</div></div></div></div></div><h2  class = 'S5' id = 'H_9A402150' ><span>Element stiffness matrix computation on CPU (symmetry)</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>tic;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>Ke_hs  = eStiff_vssa(Mesh, MP, sets);      </span><span style="color: rgb(60, 118, 61);">% Computation of Ke for tril(K)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>times = toc;</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S11'><span style="white-space: pre;"><span>fprintf(</span><span style="color: rgb(160, 32, 240);">'Elapsed time for computing Ke for tril(K) on serial CPU: %f\n'</span><span>,times);</span></span></div><div  class = 'S10'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="12B1865E" contenteditable="false" data-testid="output_2" style="width: 458px; max-height: 261px;" data-width="428" data-height="18" data-hashorizontaloverflow="false"><div class="textElement">Elapsed time for computing Ke for tril(K) on serial CPU: 1.566630</div></div></div></div></div><h2  class = 'S5' id = 'H_8FBF1AC3' ><span>Credits</span></h2><div  class = 'S1'><span>Written by </span><span style=' font-weight: bold;'>Francisco Javier Ramírez-Gil</span><span>, </span><a href = "http://fjramireg@gmail.com"><span>fjramireg@gmail.com</span></a></div><div  class = 'S1'><span>Code site:</span></div><ul  class = 'S12'><li  class = 'S13'><a href = "https://github.com/fjramireg/StiffMa"><span>https://github.com/fjramireg/StiffMa</span></a></li><li  class = 'S13'><a href = "https://www.mathworks.com/matlabcentral/fileexchange/76947-stiffma"><span>https://www.mathworks.com/matlabcentral/fileexchange/76947-stiffma</span></a></li></ul><div  class = 'S1'><span>Sponsors: </span></div><ul  class = 'S12'><li  class = 'S13'><a href = "https://pascualbravo.edu.co/"><span>Institución Universitaria Pascual Bravo</span></a></li><li  class = 'S13'><a href = "https://medellin.unal.edu.co/"><span>Universidad Nacional de Colombia - Medellin</span></a></li></ul><div  class = 'S1'><span>Created:  January 31, 2020. Version: 1.4</span></div><div  class = 'S1'><span>Modified:  June 15, 2020. Version: 1.5</span></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Script to compute the ELEMENTAL STIFFNESS $$\mathbf{k}_e$$ code for the VECTOR problem on the CPU
% This script is used to compute the NNZ values for the global stiffness matrix 
% $$\mathbf{K}$$ in the VECTOR problem on the CPU, i.e. numerical integration 
% of $$\mathbf{k}_e$$.
% 
% For more information, see the <https://github.com/fjramireg/StiffMa StiffMa> 
% web site.
%% Inputs

nelx = 10;              % Number of elements on X-direction
nely = 10;              % Number of elements on Y-direction
nelz = 10;              % Number of elements on Z-direction
sets.dTE = 'uint32';    % Data precision for "elements" ['uint32', 'uint64']
sets.dTN = 'single';    % Data precision for "nodes" ['single' or 'double']
%% Mesh generation

[Mesh.elements, Mesh.nodes] = CreateMesh2(nelx, nely, nelz, sets);
%% Material properties

MP.E = 200e9;      	% Elastic modulus (homogeneous, linear, isotropic material)
MP.nu = 0.3;       	% Poisson ratio
%% General Settings

[sets.nel, sets.nxe]  = size(Mesh.elements);    % Number of elements in the mesh & Number of nodes per element
[sets.nnod, sets.dim] = size(Mesh.nodes);       % Number of nodes in the mesh & Space dimension
sets.dxn = 3;                                   % Number of DOFs per node for the vector problem
sets.edof = sets.dxn * sets.nxe;                % Number of DOFs per element
sets.sz = (sets.edof * (sets.edof + 1) )/2;     % Number of NNZ values for each Ke using simmetry
sets.tdofs = sets.nnod * sets.dxn;              % Number of total DOFs in the mesh
%% Element stiffness matrix computation on CPU

tic;
Ke_hf = eStiff_vsa(Mesh, MP, sets);        % Computation of Ke for K
times = toc;
fprintf('Elapsed time for computing Ke for K on serial CPU: %f\n',times);
%% Element stiffness matrix computation on CPU (symmetry)

tic;
Ke_hs  = eStiff_vssa(Mesh, MP, sets);      % Computation of Ke for tril(K)
times = toc;
fprintf('Elapsed time for computing Ke for tril(K) on serial CPU: %f\n',times);
%% Credits
% Written by *Francisco Javier Ramírez-Gil*, <http://fjramireg@gmail.com fjramireg@gmail.com>
% 
% Code site:
%% 
% * <https://github.com/fjramireg/StiffMa https://github.com/fjramireg/StiffMa>
% * <https://www.mathworks.com/matlabcentral/fileexchange/76947-stiffma https://www.mathworks.com/matlabcentral/fileexchange/76947-stiffma>
%% 
% Sponsors: 
%% 
% * <https://pascualbravo.edu.co/ Institución Universitaria Pascual Bravo>
% * <https://medellin.unal.edu.co/ Universidad Nacional de Colombia - Medellin>
%% 
% Created:  January 31, 2020. Version: 1.4
% 
% Modified:  June 15, 2020. Version: 1.5
##### SOURCE END #####
--></body></html>